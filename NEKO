-- [[‰∏ªËÖ≥Êú¨]] --
-- [[ NEKO BF ÁµÇÊ•µÂÆåÂÖ®È´î - Êï¥Âêà TCHUB Âä†ÂØÜËàá SLOTH Ê†∏ÂøÉ ]]
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local CoreGui = game:GetService("CoreGui")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local Workspace = game:GetService("Workspace")
local localPlayer = Players.LocalPlayer

if getgenv().NEKO_RUNNING then return end
getgenv().NEKO_RUNNING = true

-- =============================================================
-- üõ†Ô∏è 1. ÂàùÂßãÂåñËàáÂÖ®ÂüüË®≠ÁΩÆ
-- =============================================================
_G.Settings = {
    ClickDelay    = 0.1,
    Distance      = 5000,
    PullEnemies   = false,
    Mode          = "None",
    FOV           = 80,
    MaxZoom       = 1000,
    CatSpeedValue = 50,
    SpeedEnabled  = false,
    InfJump       = false,
    SuperJumpEnabled = false,
    SuperJumpHeight = 150,
    StickyEnabled = false,
    StickyTarget  = nil,
    StickyOffset  = CFrame.new(3, 0, 7),
    SnapDistance  = 500,
    LerpSpeed     = 0.35,
    AutoBuyFruit  = false,
    FruitESP      = false,
    AutoPickFruit = false
}

_G.NekoRunning = true
_G.NekoAttack  = false
_G.AutoV4      = false

local Remote = ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("CommF_")
local function NuclearClean()
    local targets = {"NEKO BF", "NekoUI", "NekoTerminal_Lib", "NekoStickyMenu", "NekoMainBtn", "NekoFruitESP"}
    for _, name in ipairs(targets) do
        local obj = CoreGui:FindFirstChild(name) or localPlayer:FindFirstChild("PlayerGui"):FindFirstChild(name)
        if obj then pcall(function() obj:Destroy() end) end
    end
end
NuclearClean()

-- =============================================================
-- ‚öîÔ∏è 2. TCHUB x SLOTH Âä†ÂØÜÊà∞È¨•ÂºïÊìé (Ê†∏ÂøÉÊèõÂøÉÊâãË°ì)
-- =============================================================
local function GetTCHubKey() return math.floor(workspace:GetServerTimeNow() / 10 % 10) + 1 end

task.spawn(function()
    while true do
        local delay = _G.Settings.ClickDelay or 0.1
        task.wait(delay)
        if _G.NekoRunning and _G.NekoAttack and _G.Settings.Mode ~= "None" then
            pcall(function()
                local char = localPlayer.Character
                local tool = char and char:FindFirstChildOfClass("Tool")
                if tool and (tool.ToolTip == "Melee" or tool.ToolTip == "Sword") then
                    local Net = ReplicatedStorage.Modules:FindFirstChild("Net")
                    local Targets = {}
                    
                    local function Scan(folder)
                        if not folder then return end
                        for _, e in ipairs(folder:GetChildren()) do
                            if e ~= char and e:FindFirstChild("Humanoid") and e.Humanoid.Health > 0 then
                                local rp = e:FindFirstChild("HumanoidRootPart")
                                if rp and (rp.Position - char.HumanoidRootPart.Position).Magnitude < _G.Settings.Distance then
                                    table.insert(Targets, {e, rp})
                                    if _G.Settings.PullEnemies then rp.CFrame = char.HumanoidRootPart.CFrame * CFrame.new(0,0,-3) end
                                end
                            end
                        end
                    end

                    if _G.Settings.Mode == "Mob" or _G.Settings.Mode == "All" then Scan(workspace:FindFirstChild("Enemies")) end
                    if _G.Settings.Mode == "All" then Scan(Players) end

                    if #Targets > 0 and Net then
                        local fakeId = tostring(localPlayer.UserId):sub(2, 4) .. tostring(coroutine.running()):sub(11, 15)
                        Net["RE/RegisterAttack"]:FireServer()
                        Net["RE/RegisterHit"]:FireServer(Targets[1][2], Targets, {}, fakeId)
                    end
                end
            end)
        end
    end
end)

-- =============================================================
-- üåê 3. Âä†ËºâÂ§ñÈÉ®Ê†∏ÂøÉ (UI Ëàá SLOTH PVP)
-- =============================================================
task.spawn(function()
    -- Âä†Ëºâ PVP ËºîÂä©
    pcall(function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/SLOTH-neo/Sloth/refs/heads/main/PVP"))()
    end)
    
    -- Âä†Ëºâ UI
    local success, UIContent = pcall(function() return game:HttpGet("https://raw.githubusercontent.com/SLOTH-neo/Sloth/refs/heads/main/UI") end)
    if success then
        local NekoLib = loadstring(UIContent)()
        local myUI, screenGui = NekoLib.new("NEKO BF")
        screenGui.Parent = CoreGui
        
        -- Ê≠§ËôïÁúÅÁï•ÂéüÊú¨ÈáçË§áÁöÑ UI ‰ª£Á¢ºÔºåÁõ¥Êé•Â∞çÊé•ÊåâÈàï --
        local TabFight = myUI:Tab("Êà∞È¨•Á≥ªÁµ±")
        local F_Core = TabFight:Section("Ê†∏ÂøÉÊî∂Ââ≤‰∏≠ÂøÉ")
        F_Core:Toggle("ÂïüÂãïÂä†ÂØÜÊîªÊìä (TCHUB)", function(s) _G.NekoAttack = s end)
        F_Core:Toggle("ÈñãÂïüÊãâÊÄ™", function(s) _G.Settings.PullEnemies = s end)
        F_Core:Toggle("Ëá™Âãï V4", function(s) _G.AutoV4 = s end)
        F_Core:Button("Ê®°ÂºèÔºöÊâìÊÄ™", function() _G.Settings.Mode = "Mob"; _G.NekoAttack = true end)
        F_Core:Button("Ê®°ÂºèÔºöÂÖ®ÊÆ∫", function() _G.Settings.Mode = "All"; _G.NekoAttack = true end)

        -- ÁßªÂãï„ÄÅÊûúÂØ¶Á≠â Tab ÊåâÁÖßÂéüËÖ≥Êú¨ÈÇèËºØÂ∞çÊé•Âç≥ÂèØ
        print("üêæ ÂßäÂßäÁöÑÁµÇÊ•µÂÆåÂÖ®È´îÂ∑≤ÂïüÂãïÂñµÔºÅ")
    end
end)

-- =============================================================
-- üìç 4. ÂÖ∂‰ªñËá™ÂãïÂåñÂäüËÉΩ (V4, Speed, Sticky)
-- =============================================================
RunService.Heartbeat:Connect(function()
    if _G.NekoRunning and _G.Settings.SpeedEnabled then
        local char = localPlayer.Character
        if char and char:FindFirstChild("Humanoid") and char.Humanoid.MoveDirection.Magnitude > 0 then
            char:TranslateBy(char.Humanoid.MoveDirection * (_G.Settings.CatSpeedValue / 10))
        end
    end
    if _G.NekoRunning and _G.Settings.StickyEnabled and _G.Settings.StickyTarget then
        pcall(function()
            local myRoot = localPlayer.Character.HumanoidRootPart
            local tRoot = _G.Settings.StickyTarget.Character.HumanoidRootPart
            myRoot.CFrame = myRoot.CFrame:Lerp(tRoot.CFrame * _G.Settings.StickyOffset, _G.Settings.LerpSpeed)
        end)
    end
end)

-- Ëá™ÂãïÊ≠¶Ë£ùËâ≤
task.spawn(function()
    while task.wait(1) do
        if localPlayer.Character and not localPlayer.Character:FindFirstChild("HasBuso") then
            Remote:InvokeServer("Buso")
        end
    end
end)
